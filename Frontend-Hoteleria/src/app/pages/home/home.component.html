<div class="dashboard-hostal">
  <!-- Header del Dashboard -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1 class="dashboard-title">
        <mat-icon>hotel</mat-icon>
        Dashboard del Hostal
      </h1>
      <p class="dashboard-subtitle">Panel de control para gestión diaria</p>
    </div>
    <div class="header-actions">
      <button mat-raised-button color="primary" class="btn-nueva-reserva" (click)="abrirNuevaReserva()">
        <mat-icon>add</mat-icon>
        NUEVA RESERVA
      </button>
      <button mat-raised-button color="accent" class="btn-gestionar-habitaciones" (click)="gestionarHabitaciones()">
        <mat-icon>bed</mat-icon>
        HABITACIONES
      </button>
      <button mat-raised-button color="warn" class="btn-calendario" (click)="irACalendario()">
        <mat-icon>calendar_month</mat-icon>
        CALENDARIO
      </button>
      <button mat-icon-button color="primary" class="btn-refresh" (click)="refrescarDatos()"
        matTooltip="Refrescar datos">
        <mat-icon>refresh</mat-icon>
      </button>
    </div>
  </div>

  <!-- Estadísticas Rápidas -->
  <div class="stats-grid">
    <mat-card class="stat-card ocupacion">
      <mat-card-content>
        <div class="stat-icon">
          <mat-icon>hotel</mat-icon>
        </div>
        <div class="stat-info">
          <div class="stat-number">{{ estadisticas.ocupacionActual }}/{{ estadisticas.totalHabitaciones }}</div>
          <div class="stat-label">Habitaciones Ocupadas</div>
          <div class="stat-percentage">{{ estadisticas.porcentajeOcupacion }}%</div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card pendientes">
      <mat-card-content>
        <div class="stat-icon">
          <mat-icon>pending</mat-icon>
        </div>
        <div class="stat-info">
          <div class="stat-number">{{ estadisticas.reservasPendientes }}</div>
          <div class="stat-label">Reservas Pendientes</div>
          <div class="stat-detail">{{ estadisticas.pagosPendientes }} pagos pendientes</div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Sección Principal -->
  <div class="main-content">
    <!-- Layout para computadora: To-Do List compacta arriba, Calendario abajo -->
    <div class="desktop-layout">
      <!-- To-Do List Compacta -->
      <mat-card class="content-card todo-card-compact">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>checklist</mat-icon>
            Tareas del Día
          </mat-card-title>
          <mat-card-subtitle>Gestión de tareas diarias</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <app-todo-list></app-todo-list>
        </mat-card-content>
      </mat-card>

      <!-- Calendario de Ocupación - Estilo Timeline -->
      <mat-card class="content-card calendario-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>calendar_today</mat-icon>
            Calendario de Ocupación
          </mat-card-title>
          <mat-card-subtitle>Vista timeline de disponibilidad por habitación</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <app-home-calendar [diasCalendario]="diasCalendario" [ocupacionHabitaciones]="ocupacionHabitaciones"
            [cargando]="cargandoOcupacion" [fechaReferencia]="fechaReferencia" (mesAnterior)="onMesAnterior()"
            (mesSiguiente)="onMesSiguiente()" (celdaClick)="onCeldaClick($event)"
            (moverReserva)="onMoverReserva($event)">
          </app-home-calendar>
        </mat-card-content>
      </mat-card>
    </div> <!-- Cierre del desktop-layout -->

    <!-- Acciones Rápidas -->
    <mat-card class="content-card acciones-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>build</mat-icon>
          Acciones Rápidas
        </mat-card-title>
        <mat-card-subtitle>Gestión diaria del hostal</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="acciones-grid">
          <button mat-raised-button class="accion-btn checkin" (click)="realizarCheckIn()">
            <mat-icon>login</mat-icon>
            <span>CHECK-IN</span>
            <small>Registrar llegada</small>
          </button>

          <button mat-raised-button class="accion-btn checkout" (click)="realizarCheckOut()">
            <mat-icon>logout</mat-icon>
            <span>CHECK-OUT</span>
            <small>Registrar salida</small>
          </button>

          <button mat-raised-button class="accion-btn limpieza" (click)="gestionarLimpieza()">
            <mat-icon>cleaning_services</mat-icon>
            <span>LIMPIEZA</span>
            <small>Estado habitaciones</small>
          </button>

          <button mat-raised-button class="accion-btn pagos" (click)="gestionarPagos()">
            <mat-icon>payment</mat-icon>
            <span>PAGOS</span>
            <small>Control financiero</small>
          </button>

          <button mat-raised-button class="accion-btn reportes" (click)="generarReportes()">
            <mat-icon>assessment</mat-icon>
            <span>REPORTES</span>
            <small>Estadísticas</small>
          </button>

          <button mat-raised-button class="accion-btn mantenimiento" (click)="gestionarMantenimiento()">
            <mat-icon>handyman</mat-icon>
            <span>MANTENIMIENTO</span>
            <small>Reparaciones</small>
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Lista de Reservas del Día -->
  <mat-card class="content-card reservas-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>today</mat-icon>
        Reservas del Día
      </mat-card-title>
      <mat-card-subtitle>{{ fechaActual | date:'fullDate' }}</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <div class="reservas-lista" *ngIf="reservasHoy.length > 0; else sinReservas">
        <div class="reserva-item" *ngFor="let reserva of reservasHoy" (click)="verDetalleReserva(reserva)">
          <div class="reserva-hora">
            <div class="hora-entrada">{{ reserva.horaEntrada }}</div>
            <div class="hora-salida">{{ reserva.horaSalida }}</div>
          </div>

          <div class="reserva-info">
            <div class="cliente-nombre">{{ reserva.cliente?.nombre }} {{ reserva.cliente?.apellido }}</div>
            <div class="habitacion-info">Habitación {{ obtenerNumeroHabitacion(reserva.habitacion) }} ({{
              obtenerTipoHabitacion(reserva.habitacion) }})
            </div>
          </div>

          <div class="reserva-estado">
            <mat-chip [ngClass]="'estado-' + (reserva.estado || '').toLowerCase()" class="estado-chip">
              {{ reserva.estado }}
            </mat-chip>
          </div>

          <div class="reserva-pago">
            <mat-icon [ngClass]="(reserva.montoPagado || 0) >= (reserva.precioTotal || 0) ? 'pagado' : 'pendiente'">
              {{ (reserva.montoPagado || 0) >= (reserva.precioTotal || 0) ? 'check_circle' : 'pending' }}
            </mat-icon>
            <span>{{ (reserva.montoPagado || 0) >= (reserva.precioTotal || 0) ? 'PAGADO' : 'PENDIENTE' }}</span>
          </div>

          <div class="reserva-acciones">
            <button mat-icon-button color="primary" (click)="editarReserva(reserva)">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="accent" (click)="imprimirReserva(reserva)">
              <mat-icon>print</mat-icon>
            </button>
          </div>
        </div>
      </div>

      <ng-template #sinReservas>
        <div class="sin-reservas">
          <mat-icon>event_busy</mat-icon>
          <p>No hay reservas para hoy</p>
          <button mat-raised-button color="primary" (click)="abrirNuevaReserva()">
            Crear Primera Reserva
          </button>
        </div>
      </ng-template>
    </mat-card-content>
  </mat-card>

</div>